<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<script type="text/javascript" src="d3.min.js"></script>
	<script src="http://d3js.org/topojson.v0.min.js"></script>
	<script type="text/javascript" src="tooltip.js"><</script>
	<link type="text/css" rel="stylesheet" href="mapp.css">
</head>
<body>
	<span id="credit">
		<p class="date"> August 20, 2015 </p>
		<p class="by">by</p>
		<p class="id"> Amanda Hinchman-Dominguez, Student, Grinnell College </p>
	</span> 
	<br> </br>
	<div id="interactive_panel">
		<div id="key">
			<p> Key </p>
		<div id="keybox"></div>
			<!-- create a multigradient box -->
		</div>
		<div id="selected_country">
			<!-- grab text from d3js and display them here -->
			<table>
				<tr id="selected"> 
					<th>
						<!--  display name of hovered country -->
					</th>
				</tr>
				<tr id="totalpop"> 
					<th>
						<h3> Total Population </h3>
					</th>
					<th>
						<!-- display country totpop data  -->
					</th>
				</tr>
				<tr id="gdp"> 
					<th>
						<h3> GDP </h3>
					</th>
					<th>
						<!-- display country gdp data  -->
					</th>
				</tr>
			</table>	
		</div>
		<div id="option_panel">
		
		</div>
	</div>
	<div id="map">
		<a id="pagetitle"> World Population </a>

  		<script>
			var margin = {
    			top: 20,
    			right: 10,
    			bottom: 30,
    			left: 50
			};
			var h = window.innerHeight * 1 - margin.top - margin.bottom; 
			var w = window.innerWidth * .75 - margin.left - margin.right;
			var padding = 50;
			var var1 = [];
			var color = [];
			
			var div = d3.select("body").append("div")
				.attr("class", "tooltip")
				.style("opacity", 0);

			var svg = d3.select("body").append("svg")
				//a box to contain the map
    			.attr("width", w + margin.left + margin.right)
    			.attr("height", h + margin.top + margin.bottom)
    			.style("border", "2px solid black");

			//acesses the json and creates a projection
			var map = d3.json("WorldDistPop.json", function (json) {
    			// create a first guess for the projection
    			var center = d3.geo.centroid(json);
    			var scale = 140;
    			var offset = [w / 2, h / 2];
    			var projection = d3.geo.mercator().scale(scale).center(center)
        		.translate(offset);
    			// create the path
    			var path = d3.geo.path().projection(projection);

				for (var i = 0; i < json.features.length; i++) {
	 				var1[i] = json.features[i].properties.GDPpcap;
	 			}
				//sets a quantized scale based on the automatically-calculated data range
				var colorScale = d3.scale.quantize()
    				.range(['rgb(254,240,217)','rgb(253,204,138)',
						'rgb(252,141,89)','rgb(215,48,31)'])
    				.domain([d3.min(var1), d3.max(var1)]);
				//links the data variable to the color scale
				for (var i = 0; i < json.features.length; i++) {
	 				color[i] = colorScale(var1[i]);
	 			}

	 			//makes the map
				svg.selectAll("path")
    				.data(json.features)
    				.enter()
    				.append("path")
    					.attr("d", d3.geo.path().projection(projection))
						.attr("stroke", "black")
						.attr("fill", function(json, i) {	
							if (var1[i] > 0) { 
								return color[i];
							}
							else {
								return "grey";}
							}) //missing data is grey
								
								
    				.on("mouseover", function(d) {
    					d3.select(this).style('fill-opacity', 2);
    				})
	 				.on("mouseout", function(d) {
	 					d3.select(this).style('fill-opacity', .5);
	 				})
			});
			
		</script>
	</div>
</body>
</html>